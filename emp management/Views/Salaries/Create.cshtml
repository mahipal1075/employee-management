@* Create.cshtml - Modern form to create a new salary record *@
@model emp_management.Models.Salary
@{
    ViewData["Title"] = "Add Salary Record";
    var employee = ViewBag.Employee as emp_management.Models.Employee;
}

<div class="page-header slide-in-left">
    <h2><i class="fas fa-money-bill-wave me-3"></i>Add Salary Record</h2>
    <p class="mb-0">
        Creating salary record for <strong>@employee.FirstName @employee.LastName</strong>
    </p>
</div>

<div class="card-custom fade-in">
    <div class="card-body-custom">
        <div asp-validation-summary="ModelOnly" class="alert alert-danger mb-4"></div>

        <form asp-action="Create" method="post" id="salaryForm">
            <input type="hidden" asp-for="EmployeeId" />
            
            <div class="row g-4">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label asp-for="Month" class="form-label">
                            <i class="fas fa-calendar-day me-2"></i>Month
                        </label>
                        <select asp-for="Month" class="form-select">
                            <option value="1">January</option>
                            <option value="2">February</option>
                            <option value="3">March</option>
                            <option value="4">April</option>
                            <option value="5">May</option>
                            <option value="6">June</option>
                            <option value="7">July</option>
                            <option value="8">August</option>
                            <option value="9">September</option>
                            <option value="10">October</option>
                            <option value="11">November</option>
                            <option value="12">December</option>
                        </select>
                        <span asp-validation-for="Month" class="text-danger"></span>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="mb-3">
                        <label asp-for="Year" class="form-label">
                            <i class="fas fa-calendar me-2"></i>Year
                        </label>
                        <input asp-for="Year" class="form-control" type="number" min="2000" max="2100" />
                        <span asp-validation-for="Year" class="text-danger"></span>
                    </div>
                </div>
            </div>

            <div class="row g-4">
                <div class="col-md-4">
                    <div class="mb-3">
                        <label asp-for="Basic" class="form-label">
                            <i class="fas fa-rupee-sign me-2"></i>Basic Salary (₹)
                        </label>
                        <input asp-for="Basic" class="form-control salary-input" type="number" step="0.01" placeholder="0.00" />
                        <span asp-validation-for="Basic" class="text-danger"></span>
                    </div>
                </div>
                
                <div class="col-md-4">
                    <div class="mb-3">
                        <label asp-for="Allowances" class="form-label">
                            <i class="fas fa-plus-circle me-2"></i>Allowances (₹)
                        </label>
                        <input asp-for="Allowances" class="form-control salary-input" type="number" step="0.01" placeholder="0.00" />
                        <span asp-validation-for="Allowances" class="text-danger"></span>
                    </div>
                </div>
                
                <div class="col-md-4">
                    <div class="mb-3">
                        <label asp-for="Deductions" class="form-label">
                            <i class="fas fa-minus-circle me-2"></i>Deductions (₹)
                        </label>
                        <input asp-for="Deductions" class="form-control salary-input" type="number" step="0.01" placeholder="0.00" />
                        <span asp-validation-for="Deductions" class="text-danger"></span>
                    </div>
                </div>
            </div>

            <div class="card-custom" style="background: var(--success-gradient);">
                <div class="card-body-custom text-white">
                    <h5 class="mb-3"><i class="fas fa-calculator me-2"></i>Net Salary Calculation</h5>
                    <div class="row">
                        <div class="col-md-12">
                            <h2 id="netSalaryDisplay">₹0.00</h2>
                            <small>Basic + Allowances - Deductions</small>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-4 pt-3 border-top">
                <button type="submit" class="btn btn-success me-2">
                    <i class="fas fa-save me-2"></i>Save Salary Record
                </button>
                <a asp-action="ByEmployee" asp-route-id="@employee.Id" class="btn btn-secondary">
                    <i class="fas fa-times me-2"></i>Cancel
                </a>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        // Calculate net salary in real-time with INR formatting
        function calculateNetSalary() {
            var basic = parseFloat(document.getElementById('Basic').value) || 0;
            var allowances = parseFloat(document.getElementById('Allowances').value) || 0;
            var deductions = parseFloat(document.getElementById('Deductions').value) || 0;
            
            var netSalary = basic + allowances - deductions;
            // Format in Indian numbering system with rupee symbol
            document.getElementById('netSalaryDisplay').innerText = '₹' + netSalary.toLocaleString('en-IN', {minimumFractionDigits: 2, maximumFractionDigits: 2});
        }

        // Attach event listeners to all salary inputs
        document.querySelectorAll('.salary-input').forEach(function(input) {
            input.addEventListener('input', calculateNetSalary);
        });

        // Calculate on page load
        calculateNetSalary();
    </script>
}
